/*!
* VueCodemirror v6.0.2
* Copyright (c) Surmon. All rights reserved.
* Released under the MIT License.
* Surmon <https://github.com/surmon-china>
*/
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("vue"),t=require("codemirror"),n=require("@codemirror/state"),o=require("@codemirror/view"),r=require("@codemirror/commands"),i=require("@codemirror/language"),a=Object.freeze({autofocus:!1,disabled:!1,indentWithTab:!0,tabSize:2,placeholder:"",autoDestroy:!0,extensions:[t.basicSetup]}),u=Symbol("vue-codemirror-global-config");var c,s=function(e){var t=e.onUpdate,r=e.onChange,i=e.onFocus,a=e.onBlur,u=function(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(e);r<o.length;r++)t.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(e,o[r])&&(n[o[r]]=e[o[r]])}return n}(e,["onUpdate","onChange","onFocus","onBlur"]);return n.EditorState.create({doc:u.doc,selection:u.selection,extensions:(Array.isArray(u.extensions)?u.extensions:[u.extensions]).concat([o.EditorView.updateListener.of((function(e){t(e),e.docChanged&&r(e.state.doc.toString(),e),e.focusChanged&&(e.view.hasFocus?i(e):a(e))}))])})},l=function(e){return new o.EditorView(Object.assign({},e))},d=function(e){var t=new n.Compartment;return{compartment:t,run:function(o){t.get(e.state)?e.dispatch({effects:t.reconfigure(o)}):e.dispatch({effects:n.StateEffect.appendConfig.of(t.of(o))})}}},f=function(e,t){var n=d(e),o=n.compartment,r=n.run;return function(n){var i=o.get(e.state);r((null!=n?n:i!==t)?t:[])}},m=function(e){var t=function(){return e.state.doc.toString()},a=d(e).run,u=f(e,[o.EditorView.editable.of(!1),n.EditorState.readOnly.of(!0)]),c=f(e,o.keymap.of([r.indentWithTab])),s=d(e).run,l=d(e).run,m=d(e).run;return{focus:function(){return e.focus()},getDoc:t,setDoc:function(n){n!==t()&&e.dispatch({changes:{from:0,to:e.state.doc.length,insert:n}})},reExtensions:a,toggleDisabled:u,toggleIndentWithTab:c,setTabSize:function(e){s([n.EditorState.tabSize.of(e),i.indentUnit.of(" ".repeat(e))])},setPlaceholder:function(e){l(o.placeholder(e))},setStyle:function(e){void 0===e&&(e={}),m(o.EditorView.theme({"&":Object.assign({},e)}))}}},p={type:Boolean,default:void 0},v={autofocus:p,disabled:p,indentWithTab:p,tabSize:Number,placeholder:String,style:Object,autoDestroy:p,root:Object,extensions:Array,selection:Object},g={modelValue:{type:String,default:""}},b=Object.assign(Object.assign({},v),g);!function(e){e.Change="change",e.Update="update",e.Focus="focus",e.Blur="blur",e.Ready="ready",e.ModelUpdate="update:modelValue"}(c||(c={}));var h={};h[c.Change]=function(e,t){return!0},h[c.Update]=function(e){return!0},h[c.Focus]=function(e){return!0},h[c.Blur]=function(e){return!0},h[c.Ready]=function(e){return!0};var y={};y[c.ModelUpdate]=h[c.Change];var O=Object.assign(Object.assign({},h),y),w=e.defineComponent({name:"VueCodemirror",props:Object.assign({},b),emits:Object.assign({},O),setup:function(t,n){var o=e.shallowRef(),r=e.shallowRef(),i=e.shallowRef(),d=Object.assign(Object.assign({},a),e.inject(u,{})),f=e.computed((function(){var n={};return Object.keys(e.toRaw(t)).forEach((function(e){var o;"modelValue"!==e&&(n[e]=null!==(o=t[e])&&void 0!==o?o:d[e])})),n}));return e.onMounted((function(){var a;r.value=s({doc:t.modelValue,selection:f.value.selection,extensions:null!==(a=d.extensions)&&void 0!==a?a:[],onFocus:function(e){return n.emit(c.Focus,e)},onBlur:function(e){return n.emit(c.Blur,e)},onUpdate:function(e){return n.emit(c.Update,e)},onChange:function(e,o){e!==t.modelValue&&(n.emit(c.Change,e,o),n.emit(c.ModelUpdate,e,o))}}),i.value=l({state:r.value,parent:o.value,root:f.value.root});var u=m(i.value);e.watch((function(){return t.modelValue}),(function(e){e!==u.getDoc()&&u.setDoc(e)})),e.watch((function(){return t.extensions}),(function(e){return u.reExtensions(e||[])}),{immediate:!0}),e.watch((function(){return f.value.disabled}),(function(e){return u.toggleDisabled(e)}),{immediate:!0}),e.watch((function(){return f.value.indentWithTab}),(function(e){return u.toggleIndentWithTab(e)}),{immediate:!0}),e.watch((function(){return f.value.tabSize}),(function(e){return u.setTabSize(e)}),{immediate:!0}),e.watch((function(){return f.value.placeholder}),(function(e){return u.setPlaceholder(e)}),{immediate:!0}),e.watch((function(){return f.value.style}),(function(e){return u.setStyle(e)}),{immediate:!0}),f.value.autofocus&&u.focus(),n.emit(c.Ready,{state:r.value,view:i.value,container:o.value})})),e.onBeforeUnmount((function(){f.value.autoDestroy&&i.value&&function(e){e.destroy()}(i.value)})),function(){return e.h("div",{class:"v-codemirror",style:{display:"contents"},ref:o})}}}),j=w,S=function(e,t){e.component(w.name,w),e.component("Codemirror",w),function(e,t){e.provide(u,t)}(e,t)},x={Codemirror:j,install:S};exports.Codemirror=j,exports.DEFAULT_CONFIG=a,exports.default=x,exports.install=S;//# sourceMappingURL=vue-codemirror.cjs.js.map
